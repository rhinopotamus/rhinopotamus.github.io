<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************
Copyright 2015 Robert A. Beezer

This file is part of MathBook XML.

MathBook XML is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 2 or version 3 of the
License (at your option).

MathBook XML is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with MathBook XML.  If not, see <http://www.gnu.org/licenses/>.
*********************************************************************-->
<!-- This file was originally part of the book     -->
<!-- (as copied on 2015/07/12)                     -->
<!--                                               -->
<!--   Abstract Algebra: Theory and Applications   -->
<!--                                               -->
<!-- Copyright (C) 1997-2014  Thomas W. Judson     -->

<chapter xml:id="brachistochrone" xmlns:xi="http://www.w3.org/2001/XInclude">


<title>The brachistochrone problem</title>

  <section xml:id="sec-brachistochrone-overview">
    <title>The brachistochrone problem: its significance as an illustration</title>
    <p>
      The brachistochrone problem is historically the most interesting of all the special problems mentioned in Chapter I since as we have there seen it gave the first impetus to systematic research in the calculus of variations. Since the time of the Bernoulli brothers it has been used with great regularity as an illustration by writers on the subject, and it is in many respects a most excellent one. Unfortunately in the forms originally proposed by the Bernoullis it does not require the application of an important necessary condition for a minimum which was first described by Jacobi in 1837, more than a century after the calculus of variations began to be systematically studied. A special case of this condition is the restriction on the position of the center of curvature in the problem of finding the shortest arc from a point to a curve, as described in the theorem on page 33 of the last chapter. It is perhaps at first surprising that the significance of such a simple instance of the condition escaped the early students of the calculus of variations, but a study of the older memoirs soon impresses one with a realization of the serious difficulties encountered with the methods originally used. Throughout the eighteenth century, investigators in the calculus of variations for the most part desisted when they had found the forms, or in many cases the differential equations only, of the minimizing curves which they were seeking.
    </p>
    <p>
      It is natural at first sight to suppose that a straight line is the path down which a particle will fall in the shortest time from a given point 1 to a second given point 2, because a straight line is the shortest distance between the two points, but a little contemplation soon convinces one that this is not the case. John Bernoulli explicitly warned his readers against such a supposition when he formally proposed the brachistochrone problem in 1696. The surmise, suggested by Galileo's remarks on the brachistochrone problem, that the curve of quickest descent is an arc of a circle, is a more reasonable one, since there seems intuitively some justification for thinking that steepness and high velocity at the beginning of a fall will conduce to shortness in the time of descent over the whole path. It turns out, however, that this characteristic can also be overdone; the precise degree of steepness required at the start can in fact only be determined by a suitable mathematical investigation. 
    </p>
    <figure xml:id="fig-11">
      <caption>A cycloid generated by a rolling wheel.</caption>
      <image xml:id="img-cycloid" source="images/fig-cycloid.png">
        <description>A cycloid generated by a rolling wheel.</description>
      </image>
    </figure>
    <p>
      The first step which will be undertaken in the discussion of the problem in the following pages is the proof that a brachistochrone curve joining two given points must be a cycloid. We are familiar with the cycloid as the arched locus of a point on the rim of a wheel which rolls on a horizontal line, as shown in <xref ref="fig-11"/>. It turns out that the brachistochrone must consist of a portion of one of the arches turned upside down, and the line on the under side of which the circle rolls must be located at just the proper height above the given initial point of fall.
    </p>
    <p>
      When these facts have been established we are at once faced by the problem of determining whether or not such a cycloid exists joining two arbitrarily given points. Fortunately a modification by Schwarz (1845-1923) of a method due to the Bernoulli brothers will enable us to prove that two points can always be joined by one and but one cycloid of the type desired. 
    </p>
    <p>
      When these results had been attained the eighteenth-century student was content with his progress, but we cannot be so easily satisfied because we know that in other problems of the calculus of variations further conditions on the minimizing arc are required which are quite different in character from those which have so far been described. Our doubts for this particular problem will be removed, however, by a so-called sufficiency proof which will definitely establish the fact that the time of descent from a given point 1 to a given point 2 on a suitably chosen cycloid is shorter than that on every other curve joining those two points. The method used is again that of Weierstrass, a special case of which we have already considered in <xref ref="sec-field"/> of the last chapter. The argument there given and the one which we shall see in the case of the brachistochrone are excellent illustrations of the type of proof which is effective for more general problems of the calculus of variations.
    </p>
  </section>

  <section xml:id="sec-analytic-formulation">
    <title>The analytic formulation of the problem</title>
    <p>
      In order to discuss intelligently the problem of the brachistochrone we should first deduce for ourselves the integral which represents the time required by a particle to fall under the action of gravity down an arbitrarily chosen curve joining two fixed points 1 and 2. It is agreed that the initial velocity <m>v_1</m> at the point 1 is given in advance, and that the particle is to fall without friction on the curve and without resistance in the surrounding medium. If the effects of friction or a resisting medium are to be taken into account the brachistochrone problem becomes a much more complicated one.
    </p>
    <activity>
      <p>
        I'm hiding the diagram included in the textbook under a little foldy thing. I encourage you to draw your own diagram first, based on the instructions in the next paragraph, and <em>then</em> compare your diagram to the one in the book. (This will actually help you make sense of the book's diagram when you see it, because there's some things that aren't super clear.) Label the following:
        <ul>
          <li>
            <p>
              the curve of descent <m>C</m> connecting point 1 and point 2;
            </p>
          </li>
          <li>
            <p>
              a moving particle <m>P</m> on the curve <m>C</m>;
            </p>
          </li>
          <li>
            <p>
              a tangent line to the curve <m>C</m> at the point <m>P</m>;
            </p>
          </li>
          <li>
            <p>
              the vertical and horizontal components of that tangent line;
            </p>
          </li>
          <li>
            <p>
              the angle <m>\tau</m> between the horizontal and the tangent line; and
            </p>
          </li>
          <li>
            <p>
              the downward force of gravity <m>mg</m>.
            </p>
          </li>
        </ul>
      </p>
      <solution>
        <figure xml:id="fig-12">
          <image xml:id="img-12" source="images/fig-12.png">
            <description>Diagram of a point moving along a curve under the force of gravity.</description>
          </image>
        </figure>
      </solution>
    </activity>
    
    <p>
      Let <m>m</m> be the mass of the moving particle <m>P</m> in <xref ref="fig-12"/> and <m>s</m> the distance through which it has fallen from the point 1 along the curve of descent <m>C</m> in the time <m>t</m>. In order to make our analysis more convenient we may take the positive <m>y</m>-axis vertically downward, as shown in the figure.
      <aside>
        I always think this is hilarious for some reason. I think I'll try defying gravity!
      </aside>
    </p>
    <p>
      The vertical force of gravity acting upon <m>P</m> is the product of the mass <m>m</m> by the gravitational acceleration <m>g</m>, and the only force acting upon <m>P</m> in the direction of the tangent line to the curve is the projection <m>mg \sin \tau</m> of this vertical gravitational force upon that line. But the force along the tangent may also be computed as the product <m>m \frac{d^2s}{dt^2}</m> of the mass of the particle by its acceleration along the curve. Equating these two values we find the equation
      <me>
        \frac{d^2s}{dt^2} = g \sin \tau = g \frac{dy}{ds},
      </me>
      in which a common factor <m>m</m> has been discarded and use has been made of the well-known calculus formula <m>\sin \tau = \frac{dy}{ds}</m>.
    </p>
    <activity>
      <p>
        That's not a well-known formula to me! Draw yourself a little triangle with angle <m>\tau</m> and sides <m>\Delta s</m> and <m>\Delta y</m>. Use this to conclude <m>\sin \tau = \frac{dy}{ds}</m> in the limit.
      </p>
    </activity>
    <p>
      To integrate this equation we follow a customary procedure and multiply each side by <m>2 \frac{ds}{dt}</m>. The antiderivatives of the two sides are then easily found, 
    </p>
    <activity>
      <p>
        This is honestly just rude because these antiderivatives do take a little work.
      </p>
      <ol>
        <li>
          <p>
            Start by writing down the two sides of this equation:
            <me>
              \frac{d^2s}{dt^2} = g \frac{dy}{ds}
            </me>
            Multiply both sides by <m>2 \frac{ds}{dt}</m>.
          </p>
        </li>
        <li>
          <p>
            On the RHS, use the chain rule to simplify <m>\frac{dy}{ds} \frac{ds}{dt}</m>. Then integrate with respect to <m>t</m>.
          </p>
        </li>
        <li>
          <p>
            On the LHS, some more work is necessary. What does <m>\frac{ds}{dt}</m> mean in physical terms? How about <m>\frac{d^2s}{dt^2}</m>? Replace these two things with letters better representing their physical meaning.
          </p>
          <solution>
            <p>
              <m>\frac{ds}{dt}</m> means velocity, and <m>\frac{d^2s}{dt^2}</m> means acceleration.
            </p>
          </solution>
        </li>
        <li>
          <p>
            Integrate the LHS with respect to <m>t</m>. You'll need to do a <m>u</m>-substitution. What's a smart choice for <m>u</m>?
          </p>
          <solution>
            <p>
              <me>
                \int 2av\, dt.
              </me>
              If I choose <m>u = v</m>, then <m>du = a\, dt</m>, so the integral becomes
              <me>
                \int 2u\, du = u^2 = v^2 = \left(\frac{ds}{dt}\right)^2.
              </me>
            </p>
          </solution>
        </li>
      </ol>
    </activity>
    <p>
      and since they can differ only by a constant we have
      <men xml:id="eqn-3-1">
        \left(\frac{ds}{dt}\right)^2 = 2gy+c.
      </men>
      The value of the constant <m>c</m> can be determined if we remember that the values of <m>y</m> and <m>v = \frac{ds}{dt}</m> at the initial point 1 at the fall are <m>y_1</m> and <m>v_1</m>, respectively, so that for <m>t=0</m> the last equation gives
      <me>
        v_1^2 = 2gy_1 + c.
      </me>
      With the help of the value of <m>c</m> from this equation, and the notation
      <men xml:id="eqn-3-2">
        \alpha = y_1 - \frac{v_1^2}{2g},
      </men>
      equation <xref ref="eqn-3-1"/> becomes
      <men xml:id="eqn-3-3">
        \left(\frac{ds}{dt}\right)^2 = 2gy-2gy_1 + v_1^2 = 2g(y-\alpha).
      </men>
      An integration now gives the following result which we have been seeking:
    </p>
    <theorem xml:id="thm-brachistochrone-time">
      <statement>
        <p>
          The time <m>T</m> required by a particle starting with the initial velocity <m>v_1</m> to fall from a point 1 to a point 2 along a curve is given by the integrals
          <men xml:id="eqn-3-4">
            T = \frac{1}{\sqrt{2g}}\int_o^l \frac{ds}{\sqrt{y-\alpha}}=\frac{1}{\sqrt{2g}} \int_{x_1}^{x_2} \sqrt{\frac{1+(y')^2}{y-\alpha}}\,dx
          </men>
        </p>
      </statement>
    </theorem>
    <remark>
      <p>
        It's worth pointing out that this is also a functional, because the value of this integral depends on the function (or parametrically-defined curve) you're using to connect point 1 to point 2.
      </p>
    </remark>
    <p>
      It is clear that an arc which minimizes one of the integrals <xref ref="eqn-3-4"/> expressing <m>T</m> will also minimize that integral when the factor <m>\frac{1}{\sqrt{2g}}</m> is omitted, and vice versa. Let us therefore use the notations
      <men xml:id="eqn-3-5">
        I=\int_{x_{2}}^{x_{3}} f\left(y, y^{\prime}\right) dx, \quad f\left(y, y^{\prime}\right)=\sqrt{\frac{1+(y')^2}{y-\alpha}}
      </men>
      for our integral which we seek to minimize and its integrand. Since the value of the function <m>f(y, y')</m> is infinite when <m>y = \alpha</m> and imaginary when <m>y\lt \alpha</m> we must confine our curves to the portion of the plane which lies below the line <m>y=\alpha</m> in <xref ref="fig-12"/>. This is not really a restriction of the problem since the equation <m>v^2=\left(\frac{ds}{dt}\right)^2 = 2g(y-\alpha)</m> deduced above shows that a particle started on a curve with the velocity <m>v_1</m> at the point 1 will always come to rest if it reaches the altitude <m>y=\alpha</m> on the curve, and it can never rise above that altitude. For the present we shall restrict our curves to lie in the half-plane <m>y\gt \alpha</m>. In a later section of this chapter we shall see what happens when curves are permitted which have points in common with the line <m>y=\alpha</m>.
    </p>
    <remark>
      <p>
        Be careful here to remember that we've set up our axes such that the positive <m>y</m>-axis points <em>down</em>.
      </p>
    </remark>
    <p>
      In our study of the shortest-distance problems in the last chapter the arcs to be considered were taken in the form <m>y=y(x) (x_1 \leq x \leq x_2)</m> with <m>y(x)</m> continuous on the interval <m>x_1 \leq x \leq x_2</m>, and the interval could furthermore be subdivided into parts on each of which the derivative <m>y'(x)</m> is continuous. An <em>admissible arc</em> for the brachistochrone problem will always be understood to have these properties besides the additional one that it lies entirely in the half-plane <m>y\gt a</m>. For an admissible function, however, we retain always the definition given in <xref ref="sec-shortest-arc"/>. Our problem is then to find among the admissible arcs joining the points 1 and 2, one which minimizes the integral <m>I</m>.
    </p>
  </section>

  <section xml:id="sec-first-necessary-3">
    <title>A first necessary condition</title>
    <p>
      As in our study of the problems of determining shortest distances let us suppose that a particular admissible arc <m>E_{12}</m> with the equation
      <me>
        y=y(x)\quad (x_1 \leq x \leq x_2)
      </me>
      actually furnishes a minimum for the integral <m>I</m>, and let us then seek to determine its properties. If <m>\eta(x)</m> is an admissible function having <m>\eta(x_1) = \eta(x_2) =0</m> then the family of arcs 
      <men xml:id="eqn-3-6">
        y=y(x)+a\eta(x)\quad (x_1 \leq x \leq x_2)
      </men> 
      contains <m>E_{12}</m> for the parameter value <m>a=0</m>, and for small values of <m>a</m> consists entirely of admissible arcs passing through the points 1 and 2. We must not let <m>a</m> be too large, as otherwise the corresponding curve of the family might lie partly above the line <m>y = \alpha</m>.
    </p>
    <p>
      Among the values
      <men xml:id="eqn-3-7">
        I(a)=\int_{x_{1}}^{x_{2}} f\left(y+a\eta, y^{\prime}+a \eta^{\prime}\right)\, d x
      </men>
      of the integral <m>I</m> along the arcs of the family <xref ref="eqn-3-6"/> the particular value <m>I(0)</m>, which is the value along <m>E_{12}</m>, must be a minimum, and we have therefore the necessary condition <m>I'(0)=0</m>. The value of the derivative <m>I'(0)</m> found by differentiating equation <xref ref="eqn-3-7"/> with respect to <m>a</m> and then setting <m>a=0</m>, is
      <men xml:id="eqn-3-8">
        I'(0)=\int_{x_1}^{x_2} \left[ f_y \eta + f_{y'} \eta' \right]\,dx,
      </men>
      where <m>f_y</m> and <m>f_{y'}</m> are the partial derivatives of <m>f(y, y')</m> with the arguments <m>y, y'</m> belonging to the minimizing arc <m>E_{12}</m>. 
    </p>
    <activity>
      <p>There's two ways to achieve the next important result. The book suggests one way, and I'll suggest another. The subscripts here are going to get a little hairy, so I suggest rewriting <xref ref="eqn-3-8"/>in Leibniz notation:
      <me>
        I'(0)=\int_{x_1}^{x_2} \left[ \frac{\partial f}{\partial y} \eta + \frac{\partial f}{\partial y'} \eta' \right]\,dx
      </me>
      </p>
      <ol>
        <li>
          <p>
            Rewrite <xref ref="eqn-3-8"/> as the sum of two integrals. The second one, involving <m>\eta'</m>, is a natural candidate for integration by parts. Do that, then combine the two integrals again; you should now be able to factor out an <m>\eta</m>.
          </p>
          <solution>
            <p>
              <me>
                I'(0) = \int_{x_1}^{x_2} \left[\frac{\partial f}{\partial y} - \frac{d}{dx}\frac{\partial f}{\partial y'}\right] \eta \, dx
              </me>
            </p>
          </solution>
        </li>
        <li>
          <p>
            We know <m>I'(0) =0</m>, no matter which variation <m>\eta</m> you choose, so that means we can invoke the corollary to <xref ref="lemma-fundamental"/> that we proved in <xref ref="activity-fun-lemma2"/>. What can you conclude?
          </p>
        </li>
        <li>
          <p>
            Another way you could rewrite <m>I'(0)</m> -- and the way the book does it -- is by messing with the first integral. Pretend it's not a definite integral for a hot second, and just use integration by parts to come up with an antiderivative. (Hint: Let <m>u = \eta</m>, and write down some reasonable thing for the antiderivative of <m>dv</m>, even though you don't know exactly what it is.)
          </p>
        </li>
        <li>
          <p>
            Take the thing you found for the first integral and differentiate it <em>with respect to</em> <m>x</m>.
          </p>
        </li>
      </ol>
    </activity>
    <p>
      If we make use of the easily derived formula
      <me>
        \eta f_{y}=\frac{d}{dx}\left(\eta \int_{x_{1}}^{x} f_{y} \, dx\right)-\eta^{\prime} \int_{x_{1}}^{x} f_{y}\,dx
      </me>
      and the fact that <m>\eta(x_1) = \eta(x_2) = 0</m>, the expression <xref ref="eqn-3-8"/> takes the form
      <me>
        I^{\prime}(0)=\int_{x_{1}}^{x_{2}}\left\{f_{y^{\prime}}-\int_{x_{1}}^{x} f_{y} d x\right\} \eta^{\prime}\, dx.
      </me>
      This must vanish for every family of the form <xref ref="eqn-3-6"/>, i.e., for every admissible function <m>\eta(x)</m> having <m>\eta(x_1) = \eta(x_2) = 0</m>, and we find ourselves again in a position to make use of the fundamental lemma of <xref ref="sec-fundamental-lemma"/>. From that lemma it follows that:
    </p>
    <theorem xml:id="thm-euler">
      <statement>
        <p>
          For every minimizing arc <m>E_{12}</m> there must exist a constant <m>c</m> such that the equation 
          <men xml:id="eqn-3-9">
            f_{y'}=\int_{x_1}^x f_y\, dx + c
          </men>
          holds at every point of <m>E_{12}.</m> On each sub-arc of <m>E_{12}</m> where the tangent turns continuously we must have
          <men xml:id="eqn-3-10">
            \frac{d}{dx} f_{y'} = f_y.
          </men>
        </p>
      </statement>
    </theorem>
    <p>
      The last equation may be readily deduced from equation <xref ref="eqn-3-9"/> by differentiation, since on a sub-arc of <m>E_{12}</m> where the tangent turns continuously the function <m>f_y</m> is continuous and the integral in <xref ref="eqn-3-9"/> has the derivative <m>f_y</m>.
    </p>
    <p>
      The equation <xref ref="eqn-3-10"/> is the famous differential equation deduced by Euler in 1744 and called after him Euler's differential equation. Its solutions have been named <term>extremals</term> because they are the only curves which can give the integral <m>I</m> a maximum or a minimum, i.e., an extreme value. We shall in the following pages apply the term extremal only to those solutions <m>y(x)</m> which have continuously turning tangents and continuous second derivatives <m>y''(x)</m>.
      <aside>
        In more modern language, we're going to insist that <m>y(x)</m> is a function of class <m>C^2</m>.
      </aside>
    </p>
    <remark xml:id="remark-euler">
      <p>
        Most authors write Euler's equation, also sometimes called the Euler-Lagrange equation, in a slightly different form. Assuming that <m>y \in C^2</m> (that is, <m>y''(x)</m> is continuous):
        <me>
          \frac{\partial f}{\partial y} - \frac{d}{dx} \left(\frac{\partial f}{\partial y'}\right)=0.
        </me>
        <alert>Note well</alert> that the function <m>f</m> in this differential equation is in fact the integrand of whatever functional we're currently looking at (see the very general form <xref ref="eqn-gen-form"/> from <xref ref="sec-more-general"/>). For instance, in the arc length problem, the functional is
        <me>
          I = \int_{x_1}^{x_2} \sqrt{1+(y')^2}\,dx
        </me>
        so that <m>f(x,y,y') = \sqrt{1+(y')^2}</m>.
      </p>
    </remark>    

    <p>
      We have not so far made any assumption concerning the existence of a second derivative <m>y''(x)</m> along our minimizing arc. When there is one, however, we can carry out the differentiations indicated in equation <xref ref="eqn-3-10"/> and obtain
      <me>
        \frac{d}{d x} f_{y^{\prime}}-f_{y}=f_{y^{\prime} y} y^{\prime}+f_{y^{\prime} y^{\prime}} y^{\prime \prime}-f_{y}=0
      </me>
      from which it follows that along a minimizing arc with a second derivative <m>y''(x)</m> we have
      <me>
        \frac{d}{d x}\left(f-y^{\prime} f_{y^{\prime}}\right)=y^{\prime}\left(f_{y}-f_{y^{\prime} y} y^{\prime}-f_{y^{\prime} y^{\prime}} y^{\prime \prime}\right)=0
      </me>
      and hence also
      <men xml:id="eqn-3-11">
        f - y'f_{y'} = \text{constant.}
      </men>
    </p>

    <remark>
      <p>
        For me, these equations are hard to read in the subscript notation. Here they are in Leibniz notation instead, with some more parentheses added for clarity.
        <me>
          \frac{d}{dx} \left( \frac{\partial f}{\partial y'}\right) - \frac{\partial f}{\partial y} = 
            \left[\frac{\partial}{\partial y } \left(\frac{\partial f}{\partial y'}\right) y' + 
                  \frac{\partial}{\partial y'} \left(\frac{\partial f}{\partial y'}\right) y'' \right] - \frac{\partial f}{\partial y} = 0 
        </me>
        Here's the second one:
        <me>
          \frac{d}{dx} \left( f - y' \frac{\partial f}{\partial y'}\right) = 
            y'\left[\frac{\partial f}{\partial y} - \frac{\partial}{\partial y }\left(\frac{\partial f}{\partial y'}\right) y'
                                                  - \frac{\partial}{\partial y'}\left(\frac{\partial f}{\partial y'}\right) y''
              \right] = 0
        </me>
        And since the only thing whose derivative is zero is a constant function, 
        <me>
          f - y' \frac{\partial f}{\partial y'} = \text{constant.}
        </me>
        The last equation here is called the <term>Beltrami identity</term>; it's a special case of the Euler-Lagrange equation. <alert>Note well</alert> that these equations only work when <m>x</m> doesn't appear in the integrand of the functional -- that is, when the integrand is of the form <m>f(y, y')</m>.
      </p>
    </remark>

    <p>
      The reasoning by means of which equation <xref ref="eqn-3-11"/> has been derived is valid not only for the particular integrand function
      <me>
        f(y, y') = \sqrt{\frac{1+(y')^2}{y-\alpha}}
      </me>
      of the brachistochrone problem but also for an arbitrary function <m>f(y, y')</m> of the two variables <m>y</m> and <m>y'</m> which with its derivatives has suitable continuity properties. One can further verify readily that the proofs of equations <xref ref="eqn-3-9"/> and <xref ref="eqn-3-10"/> hold without alteration not only for this case but also for the still more general integral <m>I</m> to be studied in Chapter V for which the integrand is assumed to be a function <m>f(x, y, y')</m> of the three variables <m>x, y, y'</m>. It is evident, therefore, that the results of this section have great generality and that they may be applied to a wide variety of problems in the calculus of variations. <alert>One should note that</alert> equation <xref ref="eqn-3-11"/> cannot be expected to hold when <m>x</m> occurs in the integrand function, since in the differentiations made to obtain it the function <m>f</m> was supposed to contain only the variables <m>y</m> and <m>y'</m>.
    </p>

    <activity xml:id="activity-beltrami-arclength">
      <p>
        The fun thing about special cases is that things are generally way simpler. Let's see how this works in the case of minimizing arc length, which we considered using other methods in <xref ref="sec-straight-line"/>.
        <ol>
          <li>
            <p>
              Apply Euler's equation <m>\displaystyle \frac{\partial f}{\partial y} - \frac{d}{dx} \left(\frac{\partial f}{\partial y'}\right)=0</m> to the arc length integrand <m>f(y, y') = \sqrt{1+(y')^2}</m>:
              <ol>
                <li>
                  <p>
                    Compute <m>\dfrac{\partial f}{\partial y}</m>.
                  </p>
                </li>
                <li>
                  <p>
                    Compute <m>\dfrac{\partial f}{\partial y'}</m>.
                  </p>
                </li>
                <li>
                  <p>
                    Compute <m>\dfrac{d}{dx}\left(\dfrac{\partial f}{\partial y'}\right)</m>. (Yikes!)
                  </p>
                </li>
                <li>
                  <p>
                    Combine the pieces appropriately.
                  </p>
                </li>
              </ol>
            </p>
          </li>
          <li>
            <p>
              Now try the Beltrami identity <m>f-y'\frac{\partial f}{\partial y'} = c</m>. You've already computed all the pieces you need.
            </p>
          </li>
        </ol>
      </p>
    </activity>

    <activity xml:id="activity-euler-brachistochrone">
      <p>
        Assuming <m>y\in C^2</m> (which is true for reasons we'll get to in the next section), we can apply the Beltrami identity <xref ref="eqn-3-11"/> to the brachistochrone problem, since <m>x</m> doesn't appear in the integrand.<fn>We could also apply the Euler formula directly but it gets real messy, so we may as well use our nicer version. Try it out if you don't believe me; the issue is that <m>\frac{d}{dx}\left(\frac{\partial f}{\partial y'}\right)</m> has like three different terms in it.</fn>
        <ol>
          <li>
            <p>
              Write down <m>f(y, y')</m>.
            </p>
          </li>
          <li>
            <p>
              Compute <m>\dfrac{\partial f}{\partial y'}</m>.
            </p>
          </li>
          <li>
            <p>
              Assemble the pieces to produce a differential equation that the brachistochrone curve must satisfy. (If you get a common denominator, you can simplify a little.)
            </p>
            <solution>
              <p>
                <me>
                  \sqrt{\frac{1+(y')^2}{y-\alpha}} - y'\cdot \left[\frac{y'}{\sqrt{y-\alpha}\sqrt{1+(y')^2}}\right] = c
                </me>
                After getting a common denominator, this can be simplified to
                <me>
                  \frac{1}{\sqrt{y-\alpha}\sqrt{1+(y')^2}} = c.
                </me>
                
              </p>
            </solution>
          </li>
        </ol>
      </p>
    </activity>
  </section>

  <section xml:id="sec-application-brachistochrone">
    <title>Application to the brachistochrone problem</title>
    <p>
      For the special case of the brachistochrone problem the integrand <m>f(y, y')</m> and its partial derivatives are readily found to be
      <men xml:id="eqn-3-12">
        f=\sqrt{\frac{1+(y')^2}{y-\alpha}}, \quad
        f_{y}=-\frac{1}{2} \sqrt{\frac{1+(y')^2}{(y-a)^{3}}}, \quad
        f_{y^{\prime}}=\frac{y^{\prime}}{\sqrt{(y-\alpha)\left(1+(y')^2\right)}}
      </men>
      and the condition <xref ref="eqn-3-9"/> of the preceding section, which must hold along every minimizing arc <m>E_{12}</m>, can therefore be expressed in the form
      <me>
        \frac{y^{\prime}}{\sqrt{1+(y')^2}}=\sqrt{y-\alpha}\left\{c-\frac{1}{2} \int_{x_{1}}^{x} \sqrt{\frac{1+(y')^2}{(y-\alpha)^{3}}}\,dx\right\}
      </me>
      The second member of this equation, which we may denote by <m>\phi(x)</m>, is a continuous function of <m>x</m> since both <m>(y-\alpha)</m> and the integral in it are continuous along <m>E_{12}</m>. By solving the equation for <m>y'</m> we find that 
      <me>
        y'=\frac{\phi}{\sqrt{1-\phi^2}}
      </me>
      is also continuous. Turning again to the next to last equation with this result we see now that the second member <m>\phi(x)</m> of that equation has also a continuous derivative, since when <m>y</m> is continuous and has a continuous derivative the same is true of both <m>(y-\alpha)</m> and the integral occurring in it. Hence <m>y'</m> in the last equation must have a continuous derivative and we find the following result:
    </p>
    <p>
      <em>For the brachistochrone problem a minimizing arc <m>E_{12}</m> lying entirely below the line <m>y = \alpha</m> can have no corners and must have continuous curvature. Analytically stated, this means that the derivatives <m>y'(x)</m>, <m>y''(x)</m> exist and are continuous along <m>E_{12}</m>.</em>
    </p>
    <aside>
      In other words, <m>y\in C^2</m>.
    </aside>
    <p>
      Since we now know that the second derivative <m>y''(x)</m> exists along the minimizing arc we can be sure that the equation  <m>f=y'f_{y'} = \text{constant}</m> deduced in the preceding section also holds along it. When the values of <m>f</m> and its derivative <m>f_{y'}</m> for the brachistochrone problem are substituted from <xref ref="eqn-3-12"/> this equation becomes
      <men xml:id="eqn-3-13">
        f-y'f_{y'} = \frac{1}{\sqrt{y-\alpha}\sqrt{1+(y')^2}} = \frac{1}{\sqrt{2b}},
      </men>
      the value of the constant being chosen for convenience in the form <m>1/\sqrt{2b}</m>.
    </p>
    <remark>
      <p>
        The next paragraph is going to perform several dirty tricks. I wrote <url href="https://sbagleyteaches.wordpress.com/2020/05/15/a-really-dirty-trick/">a little blog post</url> about why they make sense.
      </p>
    </remark>
    <p>
      The curves which satisfy the differential equation <xref ref="eqn-3-13"/> may be found in the customary manner by solving the equation for <m>y' = \frac{dy}{dx}</m> and separating the variables, but we shall find them more easily if we profit by the experience of others and introduce a new variable <m>u</m> defined by the equation
      <men xml:id="eqn-3-14">
        y' = -\tan \frac{u}{2} = -\frac{\sin u}{1+\cos u}.
      </men>
       From the differential equation <xref ref="eqn-3-13"/> it follows then, with the help of some simple trigonometry, that along a minimizing arc <m>E_{12}</m> we must have
       <md>
          <mrow>y-\alpha=\frac{2 b}{1+(y')^{2}}=2 b \cos ^{2} \frac{u}{2}=b(1+\cos u),</mrow> 
          <mrow>\frac{d x}{d u}=\frac{d x}{d y} \frac{d y}{d u}=2 b \cos ^{2} \frac{u}{2}=b(1+\cos u),</mrow>
          <mrow>x=a+b(u+\sin u),</mrow>
       </md>
       where the last equation is found from the next to last by an integration and <m>a</m> is the new constant so introduced. It will be shown in the next section that curves which satisfy the first and third of these equations are the cycloids described in the following theorem:
    </p>
    <theorem xml:id="thm-cycloid">
      <statement>
        <p>
          A curve down which a particle, started with the initial velocity <m>v_1</m> at the point 1, will fall in the shortest time to a second point 2 is necessarily an arc having equations of the form
          <men xml:id="eqn-3-15">
            x-a = b(u + \sin u), \quad y-\alpha = b(1+\cos u).
          </men>
          These represent the locus of a point fixed on the circumference of a circle of radius <m>b</m> as the circle rolls on the lower side of the line 
          <me>y = \alpha = y_1 - \frac{v_1^2}{2g}. </me>
          Such a curve is called a <term>cycloid</term>.
        </p>
      </statement>
    </theorem>
    
  </section>
</chapter>
